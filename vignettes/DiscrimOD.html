<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ping-Yang Chen" />

<meta name="date" content="2017-06-01" />

<title>Finding Optimal Discrimination Designs by Hybirdizing Particle Swarm and L-BFGS Algorithms</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<style type="text/css">
  p.abstract{
    text-align: center;
    font-weight: bold;
  }
  div.abstract{
    margin: auto;
    width: 90%;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Finding Optimal Discrimination Designs by Hybirdizing Particle Swarm and L-BFGS Algorithms</h1>
<h4 class="author"><em>Ping-Yang Chen</em></h4>
<h4 class="date"><em>2017-06-01</em></h4>
<div class="abstract">
<p class="abstract">Abstract</p>
<p>This package adopts a hybrid algorithm to search for optimal discrimination designs when there are two or more than two competing models under normal or non-normal error assumption. This hybrid algorithm is chosen to efficiently solve the maximin design criteria in the optimal discrimination design problem which is usually a challenging task. It combines the particle swarm optimization (PSO) algorithm and the L-BFGS algorithm to tackle the outer and inner objectives of the maximin design criterion, respectively. The equivalence theorems for various discriminaiton criteria are also available for verifying the optimal discrimination designs.</p>
</div>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
</div>
<div id="installation" class="section level2">
<h2>Installation</h2>
<p>The current status of <strong>DiscrimOD</strong> package is in the process of <em>alpha</em> test, i.e. it is open for development tean only. Before install <strong>DiscrimOD</strong> package, one need to install R software with version 3.4.0 and then the <strong>devtool</strong> package. Next, use <code>install_github</code> command in <strong>devtool</strong> to install <strong>DiscrimOD</strong> package from Ping-Yang Chen’s github repository. The R codes are shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)
devtools::<span class="kw">install_github</span>(<span class="st">&quot;PingYangChen/DiscrimOD&quot;</span>)</code></pre></div>
<p>After installation, we use <code>library</code> to load the <strong>devtool</strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DiscrimOD)</code></pre></div>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
We revisit an example in  but find a new result of optimal design based on max-min <span class="math inline">\(T\)</span>-optimal design criterion which is different from the work in . Consider three linear and homoscedastic models with mean responses given by
<span class="math display">\[\begin{align}
\eta_1(x,\theta_1) &amp; = \theta_{10} + \theta_{11}e^x + \theta_{12}e^{-x},  \label{eq:af1}  \\
\eta_2(x,\theta_2) &amp; = \theta_{20} + \theta_{21}x + \theta_{22}x^2,       \label{eq:af2}  \\
\eta_3(x,\theta_3) &amp; = \theta_{30} + \theta_{31}\sin{\left(\frac{\pi x}{2}\right)} + \theta_{32}\cos{\left(\frac{\pi x}{2}\right)} + \theta_{33}\sin{\left(\pi x\right)}. \label{eq:af3}
\end{align}\]</span>
<p>In addition to the normal error assumption, they also set the first model, <span class="math inline">\(\eta_1(x,\theta_1)\)</span>, as the true model with parameters <span class="math inline">\(\theta_1=(\theta_{10}, \theta_{11}, \theta_{12}) = (4.5, -1.5, -2)\)</span>.</p>
<p>Define the R functions for three competing models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span>function(x, p) p[<span class="dv">1</span>] +<span class="st"> </span>p[<span class="dv">2</span>]*<span class="kw">exp</span>(x) +<span class="st"> </span>p[<span class="dv">3</span>]*<span class="kw">exp</span>(-x)
m2 &lt;-<span class="st"> </span>function(x, p) p[<span class="dv">1</span>] +<span class="st"> </span>p[<span class="dv">2</span>]*x +<span class="st"> </span>p[<span class="dv">3</span>]*x^<span class="dv">2</span>
m3 &lt;-<span class="st"> </span>function(x, p) p[<span class="dv">1</span>] +<span class="st"> </span>p[<span class="dv">2</span>]*<span class="kw">sin</span>(<span class="fl">0.5</span>*pi*x) +<span class="st"> </span>p[<span class="dv">3</span>]*<span class="kw">cos</span>(<span class="fl">0.5</span>*pi*x) +<span class="st"> </span>p[<span class="dv">4</span>]*<span class="kw">sin</span>(pi*x)</code></pre></div>
<p>We start with <span class="math inline">\(T\)</span>-optimal design for two competing models. That is, given the true model <span class="math inline">\(\eta_1\)</span> and the nominal values <span class="math inline">\(\theta_1\)</span>, we find the <span class="math inline">\(T\)</span>-optiaml designs for pairwisely discrimination from <span class="math inline">\(\eta_2\)</span> and <span class="math inline">\(\eta_3\)</span>, respectively.</p>
<p>The first step is to create the model list required by <strong>DiscrimOD</strong> package. The guideline in setting the model list can be found by calling the <code>emptyModelList</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">emptyModelList</span>(<span class="dt">N_model =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## $True
## $True$model
## [1] &quot;R or C++ Function&quot;
## 
## $True$para
## [1] &quot;Nominal Values of Parameters in True Model&quot;
## 
## 
## $Rival1
## $Rival1$model
## [1] &quot;R or C++ Function&quot;
## 
## $Rival1$paraLower
## [1] &quot;Lower Bound of Parameters in Rival1&quot;
## 
## $Rival1$paraUpper
## [1] &quot;Upper Bound of Parameters in Rival1&quot;
## 
## $Rival1$paraInit
## [1] &quot;Initial Guess of Parameters for LBFGS Algorithm in Rival1&quot;</code></pre>
<p>The model list consists of several sub-lists and its length is equal to the number fo competing models. In the first sub-list, we provide the information of the true model with two components, <code>model</code> for storing the user-defined R function (here, <code>m1</code> is assigned) and <code>para</code> is the vector fo nominal values. Starting from the second sub-list, we input the information of the rival models and each sub-list is constructed in the same way. The sub-lists for the rival models has 4 components and the first one <code>model</code> is the user-define R function. The second and third components are <code>paraLower</code> and <code>paraUpper</code>, respectively. They are the lower and upper bounds of the parameter space of the parameters of the rival model. The length of the bounds must be equal to the number of parameters in the rival model. The fourth component is the initial guess parameter for the L-BFGS algorithm. If had no idea about the initial starter, one can just randomly generate a parameter vector in the parameter space for it.</p>
<p>In our exmaple, we show how to define the model lists for both cases below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AF_para_m1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.5</span>, -<span class="fl">1.5</span>, -<span class="dv">2</span>)
<span class="co"># The first pair: \eta_1 vs \eta_2</span>
MODEL_INFO_12 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="co"># The first list should be the true model</span>
  <span class="kw">list</span>(<span class="dt">model =</span> m1, <span class="dt">para =</span> AF_para_m1),
  <span class="co"># Then the rival models are listed accordingly</span>
  <span class="kw">list</span>(<span class="dt">model =</span> m2, 
       <span class="dt">paraLower =</span> <span class="kw">rep</span>(-<span class="dv">10</span>, <span class="dv">3</span>), <span class="dt">paraUpper =</span> <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">3</span>),
       <span class="dt">paraInit =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
)
<span class="co"># The second pair: \eta_1 vs \eta_3</span>
MODEL_INFO_13 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">list</span>(<span class="dt">model =</span> m1, <span class="dt">para =</span> AF_para_m1),
  <span class="kw">list</span>(<span class="dt">model =</span> m3,
       <span class="dt">paraLower =</span> <span class="kw">rep</span>(-<span class="dv">10</span>, <span class="dv">4</span>), <span class="dt">paraUpper =</span> <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">4</span>),
       <span class="dt">paraInit =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
)</code></pre></div>
<p>For <span class="math inline">\(T\)</span>-optimal design, we specify the distance measure, squared difference between two models, in R function. The distance function also has two inputs. The first input must be the mean vector of the true model and the second input must be the mean vector of the rival model. Although the order of inputs seems to be irrelevant for the squared difference, but this input order will be important if one consider the KL-divergence. The output is the vector of distance measurements with the same length of the inputs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># xt is the mean values of the true model</span>
<span class="co"># xr is the mean values of the rival model</span>
DISTANCE &lt;-<span class="st"> </span>function(xt, xr) (xt -<span class="st"> </span>xr)^<span class="dv">2</span></code></pre></div>
<p>The algorithm settings are defined through <code>getAlgInfo()</code> function. Based on our experience, belows are the most influential tuning parameters of the PSO-QN algorithm. They are:</p>
<ul>
<li><code>nSwarm</code>: The size of the particle swarm. Typically, we set 16 or 32 partciels.</li>
<li><code>maxIter</code>: The number of maximal iterations. 200 iterations should be enough for the example here.</li>
<li><code>LBFGS_RETRY</code>: The maximal times of trails of L-BFGS algorithm. To avoid L-BFGS algorihtm collapses due to a poor initial vaector, we may want to try 3 to 5 times of the algorithm.</li>
<li><code>GRAD_EPS</code>: The tolerance for convergence test on the gradient norm. The default is <span class="math inline">\(10^{-10}\)</span>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># getAlgInfo() # Call for seeing the default settings</span>
ALG_INFO &lt;-<span class="st"> </span><span class="kw">getAlgInfo</span>(<span class="dt">nSwarm =</span> <span class="dv">16</span>, <span class="dt">maxIter =</span> <span class="dv">200</span>,        <span class="co"># PSO basic settings</span>
                       <span class="dt">LBFGS_RETRY =</span> <span class="dv">3</span>, <span class="dt">GRAD_EPS =</span> <span class="fl">1e-10</span>) <span class="co"># L-BFGS basic settings</span></code></pre></div>
<p>Use <code>DiscrimOD</code> to run the PSO-QN algorithm. In addition to the model list, distance function and the algorithm settings, we need to input the type of discrimination criterion (for pairwise discrimination it is <code>&quot;pair_fixed_true&quot;</code>), the number of suppoer points <code>nSupp</code> and the lower nad upper bound of the design space, <code>dsLower</code> and <code>dsUpper</code>, respecitvely.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run PSO-QN Algorithm for discriminating \eta_1 and \eta_2</span>
DISC_12 &lt;-<span class="st"> </span><span class="kw">DiscrimOD</span>(<span class="dt">MODEL_INFO =</span> MODEL_INFO_12, <span class="dt">DISTANCE =</span> DISTANCE, 
                     <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                     <span class="dt">nSupp =</span> <span class="dv">4</span>, <span class="dt">dsLower =</span> -<span class="fl">1.0</span>, <span class="dt">dsUpper =</span> <span class="fl">1.0</span>, 
                     <span class="dt">ALG_INFO =</span> ALG_INFO, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">round</span>(DISC_12$BESTDESIGN, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        dim_1 weight
## obs_1 -1.000  0.253
## obs_2 -0.669  0.428
## obs_3  0.144  0.247
## obs_4  0.957  0.072</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_12$BESTVAL</code></pre></div>
<pre><code>## [1] 0.001086725</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_12$CPUTIME</code></pre></div>
<pre><code>## elapsed 
##   10.09</code></pre>
<p>The output of <code>DiscrimOD</code> consists of the best design and its criterion value. It also reports the search path of the global best particle and computing time.</p>
<p>The <strong>DiscrimOD</strong> package provides the <code>equivalence</code> function for checking the equivalence theorem. We need to input the result obtain by <code>DiscrimOD</code> to this function. The other settings are the same.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EQUV_12 &lt;-<span class="st"> </span><span class="kw">equivalence</span>(<span class="dt">PSO_RESULT =</span> DISC_12, <span class="dt">MODEL_INFO =</span> MODEL_INFO_12, 
                       <span class="dt">DISTANCE =</span> DISTANCE, <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                       <span class="dt">dsLower =</span> -<span class="dv">1</span>, <span class="dt">dsUpper =</span> <span class="dv">1</span>, <span class="dt">ngrid =</span> <span class="dv">100</span>)
<span class="co"># Draw the directional derivative curve</span>
<span class="kw">plot</span>(EQUV_12$Grid_1, EQUV_12$DirDeriv, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, 
     <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Directional Derivative&quot;</span>); <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">points</span>(DISC_12$BESTDESIGN[,<span class="dv">1</span>], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DISC_12$BESTDESIGN)), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Directional derivative function of T-optimal design in the case DISC_12." />
<p class="caption">
Directional derivative function of T-optimal design in the case DISC_12.
</p>
</div>
<p>For the second case of pair discrimination, the implementation is similar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run PSO-QN Algorithm for discriminating \eta_1 and \eta_3</span>
DISC_13 &lt;-<span class="st"> </span><span class="kw">DiscrimOD</span>(<span class="dt">MODEL_INFO =</span> MODEL_INFO_13, <span class="dt">DISTANCE =</span> DISTANCE, 
                     <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                     <span class="dt">nSupp =</span> <span class="dv">5</span>, <span class="dt">dsLower =</span> -<span class="fl">1.0</span>, <span class="dt">dsUpper =</span> <span class="fl">1.0</span>, 
                     <span class="dt">ALG_INFO =</span> ALG_INFO, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">round</span>(DISC_13$BESTDESIGN, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        dim_1 weight
## obs_1 -1.000  0.192
## obs_2 -0.741  0.323
## obs_3 -0.104  0.227
## obs_4  0.634  0.177
## obs_5  1.000  0.081</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_13$BESTVAL</code></pre></div>
<pre><code>## [1] 0.005715191</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_13$CPUTIME</code></pre></div>
<pre><code>## elapsed 
##   24.75</code></pre>
<p>The equivalence thoerem shows the resulting design is <span class="math inline">\(T\)</span>-optimal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EQUV_13 &lt;-<span class="st"> </span><span class="kw">equivalence</span>(<span class="dt">PSO_RESULT =</span> DISC_13, <span class="dt">MODEL_INFO =</span> MODEL_INFO_13, 
                       <span class="dt">DISTANCE =</span> DISTANCE, <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                       <span class="dt">dsLower =</span> -<span class="dv">1</span>, <span class="dt">dsUpper =</span> <span class="dv">1</span>, <span class="dt">ngrid =</span> <span class="dv">100</span>)
<span class="co"># Draw the directional derivative curve</span>
<span class="kw">plot</span>(EQUV_13$Grid_1, EQUV_13$DirDeriv, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, 
     <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Directional Derivative&quot;</span>); <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">points</span>(DISC_13$BESTDESIGN[,<span class="dv">1</span>], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DISC_13$BESTDESIGN)), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Directional derivative function of T-optimal design in the case DISC_13." />
<p class="caption">
Directional derivative function of T-optimal design in the case DISC_13.
</p>
</div>
<p>Now, we concentrate on finding the max-min <span class="math inline">\(T\)</span>-optimal design for models <span class="math inline">\(\eta_1\)</span>, <span class="math inline">\(\eta_2\)</span> and <span class="math inline">\(\eta_3\)</span>. Here, since we have already set the lists of information for these three models, we can directly include them fom previously defined lists to form a new list for max-min approach.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MODEL_INFO_MAXMIN &lt;-<span class="st"> </span><span class="kw">list</span>(
  MODEL_INFO_12[[<span class="dv">1</span>]], MODEL_INFO_12[[<span class="dv">2</span>]], MODEL_INFO_13[[<span class="dv">2</span>]]
)
<span class="co"># Define the vector of optimal criterion values for efficiency computations</span>
OPT_VALS_PAIR &lt;-<span class="st"> </span><span class="kw">c</span>(DISC_12$BESTVAL, DISC_13$BESTVAL)</code></pre></div>
<p>In general, we suggest to use larger swarm size and iterations for searching max-min optimal discrimination design. Here, we use XXX particles and XXX iterations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ALG_INFO_MAXMIN &lt;-<span class="st"> </span><span class="kw">getAlgInfo</span>(<span class="dt">nSwarm =</span> <span class="dv">16</span>, <span class="dt">maxIter =</span> <span class="dv">400</span>,        <span class="co"># PSO basic settings</span>
                              <span class="dt">LBFGS_RETRY =</span> <span class="dv">3</span>, <span class="dt">GRAD_EPS =</span> <span class="fl">1e-10</span>)<span class="co"># L-BFGS basic settings</span></code></pre></div>
<p>To run our algorihtm to search for the max-min optimal discrimination design, we input  and the model list that consist of all three models and necessary parameter information. We also need to specify the vector of <span class="math inline">\(T\)</span>-optimal criterion values in  for the algorihtm to compute the <span class="math inline">\(T\)</span>-efficiencies.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_MAXMIN &lt;-<span class="st"> </span><span class="kw">DiscrimOD</span>(<span class="dt">MODEL_INFO =</span> MODEL_INFO_MAXMIN, <span class="dt">DISTANCE =</span> DISTANCE, 
                         <span class="dt">crit_type =</span> <span class="st">&quot;maxmin_fixed_true&quot;</span>,
                         <span class="dt">nSupp =</span> <span class="dv">5</span>, <span class="dt">dsLower =</span> -<span class="fl">1.0</span>, <span class="dt">dsUpper =</span> <span class="fl">1.0</span>, 
                         <span class="dt">MaxMinStdVals =</span> OPT_VALS_PAIR,
                         <span class="dt">ALG_INFO =</span> ALG_INFO_MAXMIN, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">round</span>(DISC_MAXMIN$BESTDESIGN, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        dim_1 weight
## obs_1 -1.000  0.224
## obs_2 -0.701  0.376
## obs_3 -0.012  0.220
## obs_4  0.575  0.119
## obs_5  1.000  0.061</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_MAXMIN$BESTVAL</code></pre></div>
<pre><code>## [1] 0.8058296</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_MAXMIN$CPUTIME</code></pre></div>
<pre><code>## elapsed 
##    70.8</code></pre>
<p>To check whether the resulting design is max-min optimal or not, we use the equivalence theorem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EQUV_MAXMIN &lt;-<span class="st"> </span><span class="kw">equivalence</span>(<span class="dt">PSO_RESULT =</span> DISC_MAXMIN, <span class="dt">MODEL_INFO =</span> MODEL_INFO_MAXMIN, 
                           <span class="dt">DISTANCE =</span> DISTANCE, <span class="dt">crit_type =</span> <span class="st">&quot;maxmin_fixed_true&quot;</span>,
                           <span class="dt">dsLower =</span> -<span class="dv">1</span>, <span class="dt">dsUpper =</span> <span class="dv">1</span>, <span class="dt">MaxMinStdVals =</span> OPT_VALS_PAIR, 
                           <span class="dt">ngrid =</span> <span class="dv">100</span>)
<span class="co"># The weight of efficiency values</span>
EQUV_MAXMIN$alpha</code></pre></div>
<pre><code>## [1] 0.6701936 0.3298064</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Draw the directional derivative curve</span>
<span class="kw">plot</span>(EQUV_MAXMIN$Grid_1, EQUV_MAXMIN$DirDeriv, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, 
     <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Directional Derivative&quot;</span>); <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">points</span>(DISC_MAXMIN$BESTDESIGN[,<span class="dv">1</span>], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DISC_MAXMIN$BESTDESIGN)), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Directional derivative function of max-min T-optimal design in the case DISC_MAXMIN." />
<p class="caption">
Directional derivative function of max-min T-optimal design in the case DISC_MAXMIN.
</p>
</div>
</div>
<div id="acceleratation-by-c-function-inputs" class="section level2">
<h2>Acceleratation by C++ Function Inputs</h2>
<p>Like widely used generic optimization function <code>optim</code>, <strong>DiscrimOD</strong> package also accepts the C++ function inputs for the models and distance measure. By doing so, the code will be accelerated.</p>
Here, we use the same example to illustrate how to write the C++ codes through <strong>Rcpp</strong> package. There are two steps to construct the C++ function inputs:

<p>To define a model, we create a C++ function with output type, <code>Rcpp::NumericVector</code>, and two <code>SEXP</code> type inputs. The first input, <code>xx</code>, is the covariate of the model which, in optimal design problems, is the support points. The second input, <code>pp</code>, is the model parameter vector.</p>
<p>In the C++ function, we need to firstly re-define the <code>SEXP</code> type inputs as Rcpp objects by <code>Rcpp::as&lt;&gt;()</code> function.<br />
The example here is an one-dimensional design problem, and therefore, all support points form a vector which can be defined by <code>Rcpp::NumericVector</code>. For higher dimensional design, the support points form a <span class="math inline">\(n\times m\)</span> matrix where <span class="math inline">\(n\)</span> is the number of support points and <span class="math inline">\(m\)</span> is the dimension of the design space. In such case, we use <code>Rcpp::NumericMatrix</code> to re-define <code>xx</code>. The model parameter must be a vector, and thus, it has to be of <code>Rcpp::NumericVector</code> type. Then we compute the response values with <strong>for</strong> loop for each support point and return the response vector. Usually the users only need to assign the proper variable type for the support points (<code>Rcpp::NumericVector</code> or <code>Rcpp::NumericMatrix</code>) and change the codes in the <strong>for</strong> loop for their optimal design problems.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Rcpp)
<span class="co">#</span>
m1_cppCode &lt;-<span class="st"> '</span>
<span class="st">  Rcpp::NumericVector m1_cpp(SEXP xx, SEXP pp) {</span>
<span class="st">  // Re-define variable types</span>
<span class="st">  Rcpp::NumericVector x = Rcpp::as&lt;Rcpp::NumericVector&gt;(xx);</span>
<span class="st">  Rcpp::NumericVector p = Rcpp::as&lt;Rcpp::NumericVector&gt;(pp);</span>
<span class="st">  Rcpp::NumericVector eta(x.size());</span>
<span class="st">  for (int i = 0; i &lt; x.size(); i++) {</span>
<span class="st">    eta[i] = p[0] + p[1]*std::exp(x[i]) + p[2]*std::exp(-x[i]);</span>
<span class="st">  }</span>
<span class="st">  return eta;</span>
<span class="st">}'</span>
m2_cppCode &lt;-<span class="st"> '</span>
<span class="st">  Rcpp::NumericVector m2_cpp(SEXP xx, SEXP pp) {</span>
<span class="st">  // Re-define variable types</span>
<span class="st">  Rcpp::NumericVector x = Rcpp::as&lt;Rcpp::NumericVector&gt;(xx);</span>
<span class="st">  Rcpp::NumericVector p = Rcpp::as&lt;Rcpp::NumericVector&gt;(pp);</span>
<span class="st">  Rcpp::NumericVector eta(x.size());</span>
<span class="st">  for (int i = 0; i &lt; x.size(); i++) {</span>
<span class="st">    eta[i] = p[0] + p[1]*x[i] + p(2)*x[i]*x[i];</span>
<span class="st">  }</span>
<span class="st">  return eta;</span>
<span class="st">}'</span>
m3_cppCode &lt;-<span class="st"> '</span>
<span class="st">  Rcpp::NumericVector m3_cpp(SEXP xx, SEXP pp) {</span>
<span class="st">  // Re-define variable types</span>
<span class="st">  Rcpp::NumericVector x = Rcpp::as&lt;Rcpp::NumericVector&gt;(xx);</span>
<span class="st">  Rcpp::NumericVector p = Rcpp::as&lt;Rcpp::NumericVector&gt;(pp);</span>
<span class="st">  Rcpp::NumericVector eta(x.size());</span>
<span class="st">  for (int i = 0; i &lt; x.size(); i++) {</span>
<span class="st">    eta[i] = p[0] + p[1]*std::sin(0.5*M_PI*x[i]) + </span>
<span class="st">      p[2]*std::cos(0.5*M_PI*x[i]) + p[3]*std::sin(M_PI*x[i]);</span>
<span class="st">  }</span>
<span class="st">  return eta;</span>
<span class="st">}'</span> 
<span class="co"># Compile C++ Codes</span>
m1_cpp &lt;-<span class="st"> </span><span class="kw">cppFunction</span>(m1_cppCode)
m2_cpp &lt;-<span class="st"> </span><span class="kw">cppFunction</span>(m2_cppCode)
m3_cpp &lt;-<span class="st"> </span><span class="kw">cppFunction</span>(m3_cppCode)

dist_cppCode &lt;-<span class="st"> '</span>
<span class="st">  Rcpp::NumericVector DISTANCE_cpp(SEXP xt, SEXP xr) {</span>
<span class="st">  // Re-define variable types</span>
<span class="st">  Rcpp::NumericVector val_t = Rcpp::as&lt;Rcpp::NumericVector&gt;(xt);</span>
<span class="st">  Rcpp::NumericVector val_r = Rcpp::as&lt;Rcpp::NumericVector&gt;(xr);</span>
<span class="st">  Rcpp::NumericVector div(val_t.size());</span>
<span class="st">  for (int i = 0; i &lt; val_t.size(); i++) {</span>
<span class="st">    div[i] = (val_t[i] - val_r[i])*(val_t[i] - val_r[i]);</span>
<span class="st">  }</span>
<span class="st">  return div;</span>
<span class="st">}'</span>
<span class="co"># Compile C++ Codes</span>
DISTANCE_CPP &lt;-<span class="st"> </span><span class="kw">cppFunction</span>(dist_cppCode)</code></pre></div>
<p>The definiation for the distance measure is simlar except that the two inputs are two response vectors generated by two competing models. Its output is still of <code>Rcpp::NumericVecotr</code> type which represents the vector of distances between two competing models at each support point. To specify the other distance measure such as <span class="math inline">\(KL\)</span>-divergence, the users only need to change the codes in the <strong>for</strong> loop.</p>
<p>To compile the C++ codes, we simply input the text of C++ codes into the <code>cppFunction</code> function. Then we input those C++ functions into the <code>$model</code> tags in the model list required by the <strong>DiscrimOD</strong> package and input the C++ function for distance measure into the <code>DiscrimOD</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run PSO-QN Algorithm for discriminating \eta_1 and \eta_2 by C++ inputs</span>
MODEL_CPP_12 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="co"># The first list should be the true model</span>
  <span class="kw">list</span>(<span class="dt">model =</span> m1_cpp, <span class="dt">para =</span> AF_para_m1),
  <span class="co"># Then the rival models are listed accordingly</span>
  <span class="kw">list</span>(<span class="dt">model =</span> m2_cpp, 
       <span class="dt">paraLower =</span> <span class="kw">rep</span>(-<span class="dv">10</span>, <span class="dv">3</span>), <span class="dt">paraUpper =</span> <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">3</span>),
       <span class="dt">paraInit =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
)
<span class="co"># Run</span>
DISC_CPP_12 &lt;-<span class="st"> </span><span class="kw">DiscrimOD</span>(<span class="dt">MODEL_INFO =</span> MODEL_CPP_12, <span class="dt">DISTANCE =</span> DISTANCE_CPP, 
                         <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                         <span class="dt">nSupp =</span> <span class="dv">4</span>, <span class="dt">dsLower =</span> -<span class="fl">1.0</span>, <span class="dt">dsUpper =</span> <span class="fl">1.0</span>, 
                         <span class="dt">ALG_INFO =</span> ALG_INFO, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">round</span>(DISC_CPP_12$BESTDESIGN, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        dim_1 weight
## obs_1 -0.463  0.073
## obs_2  0.144  0.248
## obs_3  0.751  0.427
## obs_4  1.000  0.252</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_CPP_12$BESTVAL</code></pre></div>
<pre><code>## [1] 0.0001011075</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_CPP_12$CPUTIME</code></pre></div>
<pre><code>## elapsed 
##    9.69</code></pre>
<p>One can notice that the computing time is less than using R function inputs. To check an optimal design by the equivalence theorem, we still use the same function, <code>equivalence</code>. The only difference here is the values of directional derivative function are computed via C++.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EQUV_CPP_12 &lt;-<span class="st"> </span><span class="kw">equivalence</span>(<span class="dt">PSO_RESULT =</span> DISC_CPP_12, <span class="dt">MODEL_INFO =</span> MODEL_CPP_12, 
                           <span class="dt">DISTANCE =</span> DISTANCE_CPP, <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                           <span class="dt">dsLower =</span> -<span class="dv">1</span>, <span class="dt">dsUpper =</span> <span class="dv">1</span>, <span class="dt">ngrid =</span> <span class="dv">100</span>)
<span class="co"># Draw the directional derivative curve</span>
<span class="kw">plot</span>(EQUV_CPP_12$Grid_1, EQUV_CPP_12$DirDeriv, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>); <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">points</span>(DISC_CPP_12$BESTDESIGN[,<span class="dv">1</span>], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DISC_CPP_12$BESTDESIGN)), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Directional derivative function of T-optimal design in the case DISC_CPP_12." />
<p class="caption">
Directional derivative function of T-optimal design in the case DISC_CPP_12.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run PSO-QN Algorithm for discriminating \eta_1 and \eta_3 by C++ input</span>
MODEL_CPP_13 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">list</span>(<span class="dt">model =</span> m1_cpp, <span class="dt">para =</span> AF_para_m1),
  <span class="kw">list</span>(<span class="dt">model =</span> m3_cpp,
       <span class="dt">paraLower =</span> <span class="kw">rep</span>(-<span class="dv">10</span>, <span class="dv">4</span>), <span class="dt">paraUpper =</span> <span class="kw">rep</span>(<span class="dv">10</span>, <span class="dv">4</span>),
       <span class="dt">paraInit =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
)
<span class="co"># Run</span>
DISC_CPP_13 &lt;-<span class="st"> </span><span class="kw">DiscrimOD</span>(<span class="dt">MODEL_INFO =</span> MODEL_CPP_13, <span class="dt">DISTANCE =</span> DISTANCE_CPP, 
                         <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                         <span class="dt">nSupp =</span> <span class="dv">5</span>, <span class="dt">dsLower =</span> -<span class="fl">1.0</span>, <span class="dt">dsUpper =</span> <span class="fl">1.0</span>, 
                         <span class="dt">ALG_INFO =</span> ALG_INFO, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">round</span>(DISC_CPP_13$BESTDESIGN, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        dim_1 weight
## obs_1 -1.000  0.192
## obs_2 -0.741  0.323
## obs_3 -0.104  0.227
## obs_4  0.634  0.177
## obs_5  1.000  0.081</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_CPP_13$BESTVAL</code></pre></div>
<pre><code>## [1] 0.005715191</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_CPP_13$CPUTIME</code></pre></div>
<pre><code>## elapsed 
##   16.86</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EQUV_CPP_13 &lt;-<span class="st"> </span><span class="kw">equivalence</span>(<span class="dt">PSO_RESULT =</span> DISC_CPP_13, <span class="dt">MODEL_INFO =</span> MODEL_CPP_13, 
                           <span class="dt">DISTANCE =</span> DISTANCE_CPP, <span class="dt">crit_type =</span> <span class="st">&quot;pair_fixed_true&quot;</span>,
                           <span class="dt">dsLower =</span> -<span class="dv">1</span>, <span class="dt">dsUpper =</span> <span class="dv">1</span>, <span class="dt">ngrid =</span> <span class="dv">100</span>)
<span class="co"># Draw the directional derivative curve</span>
<span class="kw">plot</span>(EQUV_CPP_13$Grid_1, EQUV_CPP_13$DirDeriv, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>); <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">points</span>(DISC_CPP_13$BESTDESIGN[,<span class="dv">1</span>], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DISC_CPP_13$BESTDESIGN)), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAGACAMAAACTGUWNAAAAclBMVEUAAAAAADoAAGYAAP8AOpAAZrY6AAA6ADo6AGY6Ojo6OpA6kNtmAABmADpmOpBmtv+QOgCQOjqQkGaQtpCQ2/+2ZgC2Zjq2/7a2///bkDrbtmbb25Db2//b/7bb/9vb////tmb/trb/25D//7b//9v///9s0ncYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPUElEQVR4nO2d64LbthGFtZblNN1tvE2sxGqaWN1dvf8rViRACbwAmMEMOCR1zg+vTA2GID4RlyEB7C6QqXbWGXh0AYCxAMBYAGAsADAWABgLAIwFAMYCAGMBgLEAwFgAYCwAMBYAGAsAjAUAxgIAYwGAsQDAWABgLAAwFgAYCwCMBQDGAgBjAYCxAMBYAGAsADAWABgLAIwFAMYCAGMBgLEAwFgAYCwAMBYAGAsAjAUAxgIAYwGAsQDAWABgLAAwFgAYCwCMBQDGAgBjAYCxAMBYAGAsADAWABgLAIwFAMYCAGMBgLEAwFgAYCwAMBYAGAsAjAUAxgIAYwGAsQDAWABgLAAwFgAYCwCMBQDGAgBjAYCxAMBYAGAsADCWMoAd5GUFQNfdegUAxgIAYwGAscwB5JohRjNFOa2qt2LPgbE1gFxHgNVRyJ9V1Vux59DYGECuK8bsquVOquqt2HPPeGYAVXrS69a8AIbucplgZjJ3UlVvxZ57xg/VBuxbb3std6FYnsOLsgaQ6z3sFUts785WA8Ce53m3nF7QJZ3rfd6Erv3gr6L2TM93Qz6A95cDNQ3F3XwA9qMPamKjlQC4HK830NM3arqsu/kB6BNgsxUBuOrctCIHatK0u1SeNSuN/eRHHc0O4KqP10/fqWmT7gwAaBPgs33wO2DdAD5eZ2sDNJvNfeJ/iq5nADBjL2iFAIieFdoAoXgAFAoMAGLuTABoEihBWwzg/eX5/cUHk+K9oJtJ3GpuAEMHawVAVL6PSgGg2XPfEICP1+e89cfrgehuawBonmW9oK8E8/MubcUEIC2wcXI1AkVoRVXQWTQEHrkDAJqCOyDbCHPcJXIMAKHqvRf0gAACm0oA2nhF6i6ZF8BUai0CIz8Ex0IA10ro849jqi902vlvz7uIGReArLwqAii6t2QAzk/fTp9/XIdkUdugp3q1zLiLZlgxeLApAE3pNsV6So2Eb33QWJcJALzKxgENgERvdGl3wGTaagAInlXugGOkaBudumGYpA3QC59tC4BvA07JoW43WIhCsgegQ6CscpP3gsTPxADAa8EDMTUAkZTVAOQ9r2MgBgA9DWJBiRb4ojMQ0wsgVwRQWLlJABxd43uKlWwjlW5odQAaBOYHcO4a37cv8V5QfCA2NS+B+gMtLq8tAQiedB0PEctKdwAANAoiQIlQhMpATA0ALdin6boqgGyUx9uJB2L1AcgJlN5b9QEQ3Q1zEwoA+gIAhoMFAYi1FFkARWFeoiepx6yDmgCy77xx3A1zc0kd1QcgJjA/ADUVACgsrlQqIYDi/pX4eYBcAOBV6c04eTAOAAZivRmnEIxbNYCcY4VoaLIR1ghFzAJASMAGAEEab0VoAUgn2igAhTtg6iAAkCUPxq0BQPkAQxQNJb0dLQ7G0Q9mtDEAagIAr5oAUkO2uQDQS0LVd/1uaPqhvNMKAIgIlI8wJAAoD+W9AIDwbZWH8l4bByAY4ZUDoD2U9yICoHc5AYD6UJ7qbpSd5LGS4toeAP1HkoyoA7u4sgkA4GILQEBAMMIAAIFLYkIAICawABB+t4CH8gBAUr1YECf0zy0uAKC4MwVQTMAKQDs58nStgSiL1uTdDfMTP5Q8HpMdAGqojgvg1IQimngEIRRBcDfKT/xQ8rjAvBCAZIQhaoQPXTwiNU+Y6m6cn/ih5HGB+boAHHeh+G9oTc2QAQCSgliQi4hu5Q4oJGAE4HL89N3VQNHH7Sx3o/zEDyWPS8zXBaCphFw/SPaGKAB4LXMcEM88r7QAgOSuGgCacREA0RBbDuCsuVjHRgEQL6KkDXh+++cP4vqtWXfD/MSO5L8pNl4XgKbzeWx//bG3PlnuRvmJHcl/U25cQsAKQPu7f/upAVDzeQAAjBU+lP/47wV3gMBEFIzrfvepZSvp7kb5iR3Jf1NuuyoALhyaXx2d6m6Yn9iR/DfltusCwFCqs7pyALIo3wwAsp3VUgCc0npgAPnOKgB41Zukl+6sLglAAQFZkEnUDaW8lkLorCYBpC6PXlg1LFkpagAg7uGZ76wCgBe7Csruj9Qq21kFAC9+GyAdAYzPuz4Awijf4p8HAMCEeAA4q6XYA2ATWAqAj39HBrqs1VJ4AKp0LucF0DteBQBvrYhxTlUA1Aha8OztAPBWS1kfAGEWcAeIbOVZqA+At1rKKKPp6wOAu6IAWKulLAAAk8AKAPDcAQBBiwFAvfzHBsAaiK0NgHQkogcgKt5ArAqAOr9pnnEVAJTpYcJuqAGASn2maUsRgBNlehhvDxkAIMkZut927p0s3AFJSwkA99vOvpVYcyAGAJTXQiUDsez1kQrgwQEQ3U3laPEAxKYPAaBOgFnHdFYAhD1kFgFAXK8wTGUAKixXs10Ak7b9Y0t4KA8AFAFAiesKAGgr1UiCcQAwKU4oQhaM0wDALv+1AJgjFJG/QA2L4hTiwKkIAK0bKnsrAgAmxQGwxjuAnGQNAGTBOACY1GzBOJUmdikApqxnAUB0N5UlDQAF5b8aAIxQBHX/AACgqGAkDAAAwBEtEdO1PgA3R+ztC2GlCACoAOD9xXVsur8pVQOQtdkwgNtqoYqrpfTzBADTCmNBrfTWC1IHUFT+6wBQZQeNhQCgJTMHUGEbq8cCMDjCbgMO3QG9taO3DGBsLwRwexijuH/AmgCwXWsD6OKbmmtHAwBFN0P3uPfAzUjMXSsugIxRIQCdQGwugRiAjgDAaxFzxMJMKfTGS8v/EQBMT9AAAIJwB5T5BgCG8gn5rjcKIGlWDKBKnHuYBAAkKQGAYgYAbHeqAMrLP5u0xDUAMLR8AMKdY2LnBYC87u8FHQpyEXHXiQ8gYbdpAC4WJ9zCanzepQCoEWat0AY0t4EsGF0TgKT8qwT59on/FTfCZ+EkySgA8jU+OIBL8qG8e3J8Js8RAwCCRndA4pFwC6B9bYW0hQkAUMRpAxoAvuhJM2QAgCBOL6gB4B/ak+aIaQIQlX+VMKsqANo4YI47IGZZEUCha2UAlJGwm8ZxuBC3MNk4gH46vV5QWlcG14oqvvE8AHgVT1ESvRc3Ou9+9CGrOgBqBJmq3AG03ZTI7vaDvwQ9OIDMbkq8xToUAUjLfz0AkvMDmIt1rANAsetaAOJ1EHepgiUBqDDCmx8Ad7GOIgDTto8EIF4FzXIHrAdAL+U8jTBzsQ4AIGhoeEx2Q3mLdawCgMDzfvKj08IGYlIA8vKvMcBQBKAmAPCqBKBwIMa7yAnrRwDgyvbpW2ohgtKB2IIBSDyrAjh1k/QST+WLu6EAEJc3PHdPw06JBzPcLUzUAGiU/7IB3Hr/1+5QhYEY8ypH5ioAKvRv9xOfvEqfiJ0+/ycxECgdiC0XgMxzBQCZxToKB2IAENegCgpXjShRFQA65b9oAPdG+O0n0Ru6KgCG9koA9LtX+9GHm8q7obSJAqQtTLqcsa9yNgBCz5oA/EBMGAoCgE4LiQWpANAqf/3WHQBEfhVcx4ONlbqh3GBcIYB+inoAxJ51AbiBbgoAOxinAUCv/PUbl3gvrwoAfigCALLiAOC/FQEAWS3zDkgGGiVSblxmBsAPxikAUC1/9dZ9H3NUBwA7GNdmreQ65wCg4XluAER3gfbLAqBdt0Xv8OLXUjS3MPGZK7rQeA9bJmWyWgBYWjWAVPig1NuWAaiXvzbZWCO3HAD7wiuNNm9S6aKN/cCWA4DvP0hYofy1Pe/nBzCTu33k0hQ8t861nE172gCASr//1nHF8IbXJgCsWQBgLAAwFgAYCwCMBQDGAgBjmQGAvIwAKDmW5cru1AWJAcA4MQAYJwYA48QAYJwYAIwTA4BxYgAwTgwAxokROzAWABgLAIwFAMYCAGMBgLEAwFgAYCwAMBYAGAsAjAUAxgIAY9UA8PaP2zy/M3OT3ND+vmsWP+2sJ75ILrkCgPeX20TLZiW0MyM7PXvm6mm9tHOe+CK6ZH0A5/tMVzeZib4MYN+eN2O5l3bOE19El6wP4Lx7vl2A23gysSnKQH3704Fz3l7aOU8su+QqbcA9N+29TP9B9e2PP+8YW3z30s554lbFl1wXgKsL6TViz/79pVmR4kgtiF7aOU/sHJRe8oIBDHyx0s554r71sgDIagJ36AttIVPNKoh34laLqIJOXc1Z0iK1iSfsyV1CxUaYd+JWC22ERb1Bdynk35JeN5R54lbFl1wXgGw81F4FvS3UG4gxT9ymX9BAzOfGLch+YkYEvL1LfLxWS4yKuJd2zhNfJJeMYJyxAMBYAGAsADAWABgLAIwFAMYCAGMBgLEAwFgAYCwAMBYAGAsAjAUAxgIAYwGAsQDAWABgLAAwFgAYCwCMBQDGAgBjAYCxAMBYjwjg/ZfYXqQGMgZw9GuNt9uznnf+tUr3kuX1289/v/q3XrtDXu3m9m0i7+HQ/xjKTyG9vbN5vE1Aauej3naGve9XPXy5NpiEqi5rAPeNcT/asn778hwC+HH2b8mee2/Luv2Mj005OQ/ttKLgYyA/hbR5Zb8t2OOnP375073Fv/vanbavAYBgEqq+lgMgmFsRAHh/OQwNb7NXPl5vpd6WWfDxLj+F9P3Fg72mvVZBjenNy2GYq0kPlbQYAG0JtYcOIYDrD/Z7+G2rbkP1/32/eWhKM/h4UziFNAAQnvv09fL+r193n/54cbfF7unX3mSx0IO+FgPgNiXoerUhAD9fJSyS3m82dweEkydO12+uNdRfLYBwS8y22mrbgIb3efiC/5YB+Eb4uTe5JQTgp0yENVDvdugq/kPvY6iu+M6u7X374trpe5vrPTYHHO7jAwG4FWwMQNs29Kcs9gF0BHsfQ4VVkEfUGDkATZpP39vPzT/ONn4P6WsxAGJVUFsu/VmHU1XQ4GOooPhcyTaNcFPoz7fvbwBOjwvg3gg3Le/BfTy4A38POipdI9z0TVkA3J10BdDg7szPuANaNT++ax3xZzMQOIVdn/PTb4M5uxPd0IGzUGc3vvBzT6+FewXQFHFXr4UA/DTfhwTQdkCuI1xX7Rz8gUtTzj8PS7YdiH283gdiI2ehcevGNejPrhf0V+v/5FuOw+UGoC37R+wFuRUW3Gc34zMIEpzGS5fcgwjkKqibe9q6Pty9uGFaB2A8DrhsGsCUfueuV8UVgnHQXesB0Ayg7tWVlmk1D1StB8BGBQDGAgBjAYCxAMBYAGAsADAWABgLAIwFAMYCAGMBgLEAwFgAYCwAMBYAGAsAjAUAxgIAYwGAsQDAWP8HFgOksicHfzcAAAAASUVORK5CYII=" alt="Directional derivative function of T-optimal design in the case DISC_CPP_13." />
<p class="caption">
Directional derivative function of T-optimal design in the case DISC_CPP_13.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MODEL_CPP_MAXMIN &lt;-<span class="st"> </span><span class="kw">list</span>(
  MODEL_CPP_12[[<span class="dv">1</span>]], MODEL_CPP_12[[<span class="dv">2</span>]], MODEL_CPP_13[[<span class="dv">2</span>]]
)
<span class="co">#</span>
OPT_VALS_CPP_PAIR &lt;-<span class="st"> </span><span class="kw">c</span>(DISC_CPP_12$BESTVAL, DISC_CPP_13$BESTVAL)
<span class="co"># Run</span>
DISC_CPP_MAXMIN &lt;-<span class="st"> </span><span class="kw">DiscrimOD</span>(<span class="dt">MODEL_INFO =</span> MODEL_CPP_MAXMIN, <span class="dt">DISTANCE =</span> DISTANCE_CPP, 
                             <span class="dt">crit_type =</span> <span class="st">&quot;maxmin_fixed_true&quot;</span>,
                             <span class="dt">nSupp =</span> <span class="dv">5</span>, <span class="dt">dsLower =</span> -<span class="fl">1.0</span>, <span class="dt">dsUpper =</span> <span class="fl">1.0</span>, 
                             <span class="dt">MaxMinStdVals =</span> OPT_VALS_CPP_PAIR,
                             <span class="dt">ALG_INFO =</span> ALG_INFO_MAXMIN, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">round</span>(DISC_CPP_MAXMIN$BESTDESIGN, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        dim_1 weight
## obs_1 -1.000  0.192
## obs_2 -0.741  0.323
## obs_3 -0.104  0.227
## obs_4  0.634  0.177
## obs_5  1.000  0.081</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_CPP_MAXMIN$BESTVAL</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DISC_CPP_MAXMIN$CPUTIME</code></pre></div>
<pre><code>## elapsed 
##   53.09</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">EQUV_CPP_MAXMIN &lt;-<span class="st"> </span><span class="kw">equivalence</span>(<span class="dt">PSO_RESULT =</span> DISC_CPP_MAXMIN, <span class="dt">MODEL_INFO =</span> MODEL_CPP_MAXMIN, 
                               <span class="dt">DISTANCE =</span> DISTANCE_CPP, <span class="dt">crit_type =</span> <span class="st">&quot;maxmin_fixed_true&quot;</span>,
                               <span class="dt">dsLower =</span> -<span class="dv">1</span>, <span class="dt">dsUpper =</span> <span class="dv">1</span>, <span class="dt">MaxMinStdVals =</span> OPT_VALS_CPP_PAIR, 
                               <span class="dt">ngrid =</span> <span class="dv">100</span>)
<span class="co"># The weight of efficiency values</span>
EQUV_CPP_MAXMIN$alpha</code></pre></div>
<pre><code>## [1] 3.749152e-33 1.000000e+00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Draw the directional derivative curve</span>
<span class="kw">plot</span>(EQUV_CPP_MAXMIN$Grid_1, EQUV_CPP_MAXMIN$DirDeriv, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">points</span>(DISC_CPP_MAXMIN$BESTDESIGN[,<span class="dv">1</span>], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(DISC_CPP_MAXMIN$BESTDESIGN)), <span class="dt">pch =</span> <span class="dv">19</span>)</code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Directional derivative function of max-min T-optimal design in the case DISC_CPP_MAXMIN." />
<p class="caption">
Directional derivative function of max-min T-optimal design in the case DISC_CPP_MAXMIN.
</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
